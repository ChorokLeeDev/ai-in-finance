{
  "config": {
    "num_passages": 50,
    "queries_per_passage": 2,
    "num_negatives": 5,
    "head_epochs": 20,
    "router_epochs": 30,
    "finetune_epochs": 10,
    "lr": 0.0001,
    "diversity_weight": 0.1,
    "output_dir": "outputs",
    "device": "cpu",
    "seed": 42
  },
  "head_training": {
    "keyword": {
      "losses": [
        1.7860115742683411,
        1.7661168205738067,
        1.727449654340744,
        1.6749155080318452,
        1.5947732782363893,
        1.5155684280395507,
        1.3883835071325301,
        1.2943087232112884,
        1.2179669216275215,
        1.1358582657575607,
        1.121858910433948,
        0.9917803037166596,
        0.951825853716582,
        0.8492896181158721,
        0.8714057911932468,
        0.8102359286881984,
        0.7129898732714355,
        0.614859999557957,
        0.6287786608049646,
        0.6199851858150214
      ],
      "final_loss": 0.6199851858150214
    },
    "semantic": {
      "losses": [
        1.7862929844856261,
        1.7625834918022156,
        1.7147375786304473,
        1.6422828865051269,
        1.5409540271759032,
        1.4375498735904693,
        1.3341184592247008,
        1.2693790519237518,
        1.1298985629528762,
        1.0960549615323543,
        1.013667190670967,
        0.9433424659073353,
        0.8628943926468492,
        0.8522627619281411,
        0.7585988400736824,
        0.7517352863773703,
        0.7192442463710904,
        0.639719362296164,
        0.5852923528198153,
        0.5691617452143691
      ],
      "final_loss": 0.5691617452143691
    }
  },
  "router_training": {
    "losses": [
      0.2702830545709003,
      0.015392555166799866,
      0.0031461168828991505,
      0.001562015457079724,
      0.0009228977493421553,
      0.0006001436778149127,
      0.0004271531850719157,
      0.00029358084608048783,
      0.00023908556882872744,
      0.0001716325829931975,
      0.00013364387760319118,
      0.00010054229389609759,
      8.288046038231301e-05,
      7.367381423488695e-05,
      5.759821680069166e-05,
      4.581400974014826e-05,
      3.634715423789459e-05,
      2.928384431303499e-05,
      2.5153666087263106e-05,
      2.129577911883729e-05,
      1.8460645514117856e-05,
      1.856904760238365e-05,
      1.2596521052898879e-05,
      1.2202857991319149e-05,
      1.0144423194091701e-05,
      1.0900633961377081e-05,
      6.276287248887513e-06,
      5.950816528859093e-06,
      7.328745155099625e-06,
      4.81241683836231e-06
    ],
    "accuracies": [
      0.955,
      0.995,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0,
      1.0
    ],
    "final_accuracy": 1.0
  },
  "finetuning": {
    "losses": [
      {
        "total": 0.9178099573403596,
        "task": 0.9168444690853357,
        "diversity": 0.0009654882550239563,
        "load_balance": 2.708944180085382e-14
      },
      {
        "total": 0.922397796958685,
        "task": 0.9207876844704151,
        "diversity": 0.001610112488269806,
        "load_balance": 4.440892098500626e-14
      },
      {
        "total": 0.9587379825860262,
        "task": 0.9568571672588587,
        "diversity": 0.001880815327167511,
        "load_balance": 3.197442310920451e-14
      },
      {
        "total": 0.9436098480969668,
        "task": 0.9423141203075648,
        "diversity": 0.0012957277894020082,
        "load_balance": 1.4210854715202004e-14
      },
      {
        "total": 0.9015774248540401,
        "task": 0.9002510319650173,
        "diversity": 0.0013263928890228272,
        "load_balance": 1.389999226830696e-13
      },
      {
        "total": 0.8857926426827908,
        "task": 0.8836707465350628,
        "diversity": 0.0021218961477279664,
        "load_balance": 4.440892098500626e-14
      },
      {
        "total": 0.8955857154726982,
        "task": 0.8948822620511055,
        "diversity": 0.0007034534215927124,
        "load_balance": 5.684341886080802e-14
      },
      {
        "total": 0.9340464427322149,
        "task": 0.9330153774470091,
        "diversity": 0.001031065285205841,
        "load_balance": 2.3092638912203256e-14
      },
      {
        "total": 0.9101821874082089,
        "task": 0.9097390000522136,
        "diversity": 0.0004431873559951782,
        "load_balance": 6.004086117172847e-13
      },
      {
        "total": 0.9002995972335338,
        "task": 0.8998562775552272,
        "diversity": 0.0004433196783065796,
        "load_balance": 2.877698079828406e-13
      }
    ]
  },
  "evaluation": {
    "task_accuracy": {
      "overall_accuracy": 1.0,
      "per_type_accuracy": {
        "keyword": 1.0,
        "semantic": 1.0
      },
      "correct_head_wins": 200,
      "total_comparisons": 200
    },
    "routing_accuracy": {
      "accuracy": 1.0,
      "top2_accuracy": 1.0,
      "total": 200,
      "confusion": {
        "keyword": {
          "keyword": 100,
          "semantic": 0
        },
        "semantic": {
          "keyword": 0,
          "semantic": 100
        }
      }
    },
    "retrieval_quality": {
      "mrr": 0.9458333333333334,
      "recall@1": 0.895,
      "recall@5": 1.0,
      "num_samples": 200
    },
    "head_diversity": {
      "avg_pairwise_similarity": 0.43116000294685364,
      "diversity_score": 0.5688399970531464,
      "num_head_pairs": 1
    },
    "soft_vs_hard": {
      "soft_mrr": 0.9383333333333335,
      "hard_mrr": 0.9641666666666667,
      "mrr_delta": -0.025833333333333264,
      "soft_recall@1": 0.88,
      "hard_recall@1": 0.93,
      "recall@1_delta": -0.050000000000000044
    },
    "baselines": {
      "single_attention": {
        "mrr": 0.9716666666666666,
        "recall@1": 0.945
      },
      "random_routing": {
        "mrr": 0.7525999999999999,
        "mrr_std": 0.015123418190930856,
        "recall@1": 0.606,
        "recall@1_std": 0.028354893757515674
      }
    }
  }
}